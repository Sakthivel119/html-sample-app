pipeline {
    agent any
    environment {
        SONAR_HOME = 'C:\\Users\\Administrator\\Documents\\tools\\sonar-scanner\\bin'
        REPO_NAME  = 'https://github.com/Sakthivel119/html-sample-app.git'
        BRANCH_NAME = 'master'
        SONAR_TOKEN  = credentials('sakthivel-sonar--project-token')
        //DOCKER_CREDS = 'ashutoshh-dockerhub'
        SONAR_PROJECT_KEY =  'Sakthivel-iis-project'
        SONAR_HOST_URL = 'http://13.203.151.240:9000'
        SONAR_SERVER_NAME = 'Sakthivel-iis-project' // name we have configured under jenkins global confir
    }
    stages {
        // stage1
        stage('Hello') {
            steps {
                echo 'Hello World'
            }
        }
     // stage to verify sonar-scanner 
     stage('sonar-scaner verify'){
         steps {
             echo 'checking version'
             // bat or pwsh
             bat """
             sonar-scanner --version
             docker version
             java --version
             """
           
         }
     }
      stage('taking code of github repo'){
            steps {
                echo 'clone repo to project'
                git url: "${REPO_NAME}", branch: "${BRANCH_NAME}"
            }
        }
       // doing sast with sonar-qube 
        /*stage('SAST with sonar-scanner'){
            steps {
                echo 'wait for sonar-scanner to finish'
                bat """
                 %SONAR_HOME%\\sonar-scanner \
                -Dsonar.projectKey=${SONAR_PROJECT_KEY} \
                -Dsonar.sources=. \
                -Dsonar.host.url=${SONAR_HOST_URL} \
                -Dsonar.token=${SONAR_TOKEN}
                """
            }
        }*/
    }
}
